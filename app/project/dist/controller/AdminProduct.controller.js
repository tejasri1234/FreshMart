sap.ui.define(["sap/ui/core/mvc/Controller","sap/ui/core/Fragment","sap/ui/model/json/JSONModel","sap/m/MessageToast","sap/m/MessageBox","sap/m/ActionSheet","sap/m/Button"],function(e,t,o,i,s,n,a){"use strict";return e.extend("project.controller.AdminProduct",{onInit:function(){this.oModel=this.getOwnerComponent().getModel();this.getView().setModel(new sap.ui.model.json.JSONModel({results:[]}),"searchModel")},onOpenDialog:function(){const e=this.getView();if(!this._oDialog){t.load({id:e.getId(),name:"project.view.ProductDialog",controller:this}).then(t=>{this._oDialog=t;e.addDependent(t);t.open()})}else{this._oDialog.open()}this._editingProductId=null},onOpenActionSheet:function(e){const t=e.getSource().getBindingContext();const o=t.getObject();const i=new n({buttons:[new a({text:"Edit",icon:"sap-icon://edit",press:()=>this.onEditProduct(t)}),new a({text:"Delete",icon:"sap-icon://delete",press:()=>this.onDeleteProduct(o.id)})]});i.openBy(e.getSource())},onEditProduct:function(e){if(!e){i.show("No product data found.");return}const o=Object.assign({},e.getObject());this._editingProductId=o.id;const s=this.getView();if(!this._oDialog){t.load({id:s.getId(),name:"project.view.ProductDialog",controller:this}).then(e=>{this._oDialog=e;s.addDependent(e);this._populateDialogFields(o);e.open()})}else{this._populateDialogFields(o);this._oDialog.open()}},_populateDialogFields:function(e){const t=this.getView().getId();sap.ui.core.Fragment.byId(t,"inputName").setValue(e.name);sap.ui.core.Fragment.byId(t,"inputPrice").setValue(e.price);sap.ui.core.Fragment.byId(t,"inputQuantity").setValue(e.quantity);sap.ui.core.Fragment.byId(t,"inputStock").setValue(e.stock);sap.ui.core.Fragment.byId(t,"inputCategory").setSelectedKey(e.category_name);sap.ui.core.Fragment.byId(t,"inputImage").setValue(e.image)},onDeleteProduct:function(e){const t=`/Product(${e})`;this.getView().getModel().remove(t,{success:()=>i.show("Product deleted successfully."),error:()=>i.show("Failed to delete product.")})},onDialogCancel:function(){if(this._oDialog){this._oDialog.close()}this._editingProductId=null},onDialogSave:function(){const e=this.getView().getId();const t=sap.ui.core.Fragment.byId(e,"inputName");const o=sap.ui.core.Fragment.byId(e,"inputPrice");const s=sap.ui.core.Fragment.byId(e,"inputQuantity");const n=sap.ui.core.Fragment.byId(e,"inputStock");const a=sap.ui.core.Fragment.byId(e,"inputCategory");const r=sap.ui.core.Fragment.byId(e,"inputImage");if(!t||!o||!s||!n||!a||!r){i.show("Some input fields are missing.");return}const c={name:t.getValue(),price:o.getValue(),quantity:s.getValue(),stock:n.getValue(),category_name:a.getSelectedKey(),image:r.getValue()};const d=this.getView().getModel();if(this._editingProductId!==undefined&&this._editingProductId!==null){const e=`/Product(${this._editingProductId})`;d.update(e,c,{success:()=>i.show("Product updated successfully."),error:()=>i.show("Failed to update product.")})}else{d.create("/Product",c,{success:()=>i.show("Product added successfully."),error:()=>i.show("Failed to add product.")})}if(this._oDialog){this._oDialog.close()}this._editingProductId=null},onSearch:function(e){var t=e.getParameter("query")||e.getParameter("newValue");var o=this.getView().getModel();var i=this.getView().getModel("searchModel");if(t&&t.length>0){o.read("/Product",{success:e=>{var o=e.results.filter(e=>e.name.toLowerCase().includes(t.toLowerCase()));console.log("Search results:",o);i.setProperty("/results",o)},error:()=>{console.error("Failed to fetch product data.")}})}else{i.setProperty("/results",[])}}})});
//# sourceMappingURL=AdminProduct.controller.js.map