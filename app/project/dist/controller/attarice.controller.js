sap.ui.define(["sap/ui/core/mvc/Controller","sap/ui/model/json/JSONModel","sap/ui/model/Filter","sap/m/MessageToast","sap/m/Text","sap/m/VBox"],function(e,t,s,o,n,i){"use strict";return e.extend("project.controller.attarice",{onInit:function(){jQuery.sap.includeStyleSheet("project/css/style.css");var e=sap.ui.getCore().getEventBus();e.subscribe("cart","updated",this.onCartUpdated,this);var t=this.getOwnerComponent().getModel();this.getView().setModel(t);this.getView().setModel(new sap.ui.model.json.JSONModel({results:[]}),"searchModel");var o=new s("category/name","EQ","Grains");var n=new s("category/name","EQ","Essentials");var i=this.getView().byId("grainsList");var r=this.getView().byId("essentialsList");if(i?.getBinding("items")){i.getBinding("items").filter([o])}if(r?.getBinding("items")){r.getBinding("items").filter([n])}},onMenuPress:function(e){if(!this._oMenuSheet){this._oMenuSheet=new sap.m.ActionSheet({buttons:[new sap.m.Button({text:"My Orders",icon:"sap-icon://order-status",press:()=>{const e=sap.ui.core.UIComponent.getRouterFor(this);e.navTo("Orders")}}),new sap.m.Button({text:"Account",icon:"sap-icon://account",press:()=>{sap.m.MessageToast.show("Account pressed")}})],placement:sap.m.PlacementType.Bottom});this.getView().addDependent(this._oMenuSheet)}this._oMenuSheet.openBy(e.getSource())},onProfilePress:function(){this.getOwnerComponent().onProfilePress(this.getView())},onLoginPress:function(){var e=this.getView();var t=e.byId("loginRegisterDialog");if(!t){sap.m.MessageBox.error("Dialog not open.");return}var s=e.byId("emailInput").getValue();var o=e.byId("passwordInput").getValue();if(!s||!o){sap.m.MessageBox.warning("Please enter both email and password.");return}console.log(s,o);if(s==="admin@gmail.com"&&o==="admin"){var n=this.getOwnerComponent().getRouter();n.navTo("AdminDahsboard");console.log("routing");return}e.getModel().read("/Customer",{filters:[new sap.ui.model.Filter("email",sap.ui.model.FilterOperator.EQ,s),new sap.ui.model.Filter("password",sap.ui.model.FilterOperator.EQ,o)],success:function(e){if(e.results&&e.results.length>0){var s=e.results[0];var o=new sap.ui.model.json.JSONModel(s);console.log(o);this.getOwnerComponent().setModel(o,"userModel");t.close();this.loadOrdersForUser()}else{sap.m.MessageBox.error("Invalid email or password.")}}.bind(this),error:function(){sap.m.MessageBox.error("Login failed. Please try again.")}})},onRegister:function(){this.getOwnerComponent().onRegister(this.getView())},onToggleForm:function(){this.getOwnerComponent().onToggleForm(this.getView())},onForgotPasswordPress:function(){this.getOwnerComponent().onForgotPasswordPress()},onToggleLoginPasswordVisibility:function(){this.getOwnerComponent().onToggleLoginPasswordVisibility(this.getView())},onToggleRegisterPasswordVisibility:function(){this.getOwnerComponent().onToggleRegisterPasswordVisibility(this.getView())},onCloseLoginDialog:function(){this.getOwnerComponent().onCloseLoginDialog(this.getView())},onFruitsPress:function(){var e=this.byId("grainsList");if(e){e.getDomRef().scrollIntoView({behavior:"smooth"})}},onVegetablesPress:function(){var e=this.byId("essentialsList");if(e){e.getDomRef().scrollIntoView({behavior:"smooth"})}},onSearch:function(e){var t=e.getParameter("query")||e.getParameter("newValue");var s=this.getView().getModel();var o=this;var n=this.byId("productList");if(t&&t.length>0){s.read("/Product",{success:function(e){var s=e.results.filter(function(e){return e.name.toLowerCase().includes(t.toLowerCase())});console.log("Search results:",s);o.getView().getModel("searchModel").setProperty("/results",s);n.setVisible(true)}})}else{o.getView().getModel("searchModel").setProperty("/results",[]);n.setVisible(false)}},onCartUpdated:function(){this.updateCartDisplay(this.getView())},onCartPress:function(){this.getOwnerComponent().onCartPress(this.getView())},onCloseCart:function(){this.getOwnerComponent().onCloseCart(this.getView())},updateCartDisplay:function(){this.getOwnerComponent().updateCartDisplay(this.getView())},onAddToCart:function(e){var t=e.getSource().getBindingContext();var s=t.getObject();this.getOwnerComponent().onAddToCart(s)},onPlaceOrder:function(){this.getOwnerComponent().onPlaceOrder(this.getView())}})});
//# sourceMappingURL=attarice.controller.js.map