sap.ui.define(["sap/ui/core/mvc/Controller","sap/ui/model/json/JSONModel","sap/ui/model/Filter","sap/m/MessageToast","sap/m/Text","sap/m/VBox"],function(e,t,o,s,n,i){"use strict";return e.extend("project.controller.cooldrinks",{onInit:function(){jQuery.sap.includeStyleSheet("project/css/style.css");var e=this.getOwnerComponent().getModel();this.getView().setModel(e);this.getView().setModel(new sap.ui.model.json.JSONModel({results:[]}),"searchModel");var t=sap.ui.getCore().getEventBus();t.subscribe("cart","updated",this.onCartUpdated,this);var s=new o("category/name","EQ","Soft Drinks");var n=new o("category/name","EQ","Fruit Juices");var i=this.getView().byId("softDrinksList");var r=this.getView().byId("fruitJuicesList");if(i?.getBinding("items")){i.getBinding("items").filter([s])}if(r?.getBinding("items")){r.getBinding("items").filter([n])}},onCartUpdated:function(){this.updateCartDisplay(this.getView())},onMenuPress:function(e){if(!this._oMenuSheet){this._oMenuSheet=new sap.m.ActionSheet({buttons:[new sap.m.Button({text:"My Orders",icon:"sap-icon://order-status",press:()=>{const e=sap.ui.core.UIComponent.getRouterFor(this);e.navTo("Orders")}}),new sap.m.Button({text:"Account",icon:"sap-icon://account",press:()=>{sap.m.MessageToast.show("Account pressed")}})],placement:sap.m.PlacementType.Bottom});this.getView().addDependent(this._oMenuSheet)}this._oMenuSheet.openBy(e.getSource())},onFruitsPress:function(){var e=this.byId("softDrinksList");if(e){e.getDomRef().scrollIntoView({behavior:"smooth"})}},onVegetablesPress:function(){var e=this.byId("fruitJuicesList");if(e){e.getDomRef().scrollIntoView({behavior:"smooth"})}},onProfilePress:function(){this.getOwnerComponent().onProfilePress(this.getView())},onLoginPress:function(){var e=this.getView();var t=e.byId("loginRegisterDialog");if(!t){sap.m.MessageBox.error("Dialog not open.");return}var o=e.byId("emailInput").getValue();var s=e.byId("passwordInput").getValue();if(!o||!s){sap.m.MessageBox.warning("Please enter both email and password.");return}console.log(o,s);if(o==="admin@gmail.com"&&s==="admin"){var n=this.getOwnerComponent().getRouter();n.navTo("AdminDahsboard");console.log("routing");return}e.getModel().read("/Customer",{filters:[new sap.ui.model.Filter("email",sap.ui.model.FilterOperator.EQ,o),new sap.ui.model.Filter("password",sap.ui.model.FilterOperator.EQ,s)],success:function(e){if(e.results&&e.results.length>0){var o=e.results[0];var s=new sap.ui.model.json.JSONModel(o);console.log(s);this.getOwnerComponent().setModel(s,"userModel");t.close();this.loadOrdersForUser()}else{sap.m.MessageBox.error("Invalid email or password.")}}.bind(this),error:function(){sap.m.MessageBox.error("Login failed. Please try again.")}})},onRegister:function(){this.getOwnerComponent().onRegister(this.getView())},onToggleForm:function(){this.getOwnerComponent().onToggleForm(this.getView())},onForgotPasswordPress:function(){this.getOwnerComponent().onForgotPasswordPress()},onToggleLoginPasswordVisibility:function(){this.getOwnerComponent().onToggleLoginPasswordVisibility(this.getView())},onToggleRegisterPasswordVisibility:function(){this.getOwnerComponent().onToggleRegisterPasswordVisibility(this.getView())},onCloseLoginDialog:function(){this.getOwnerComponent().onCloseLoginDialog(this.getView())},onSearch:function(e){var t=e.getParameter("query")||e.getParameter("newValue");var o=this.getView().getModel();var s=this;var n=this.byId("productList");if(t&&t.length>0){o.read("/Product",{success:function(e){var o=e.results.filter(function(e){return e.name.toLowerCase().includes(t.toLowerCase())});console.log("Search results:",o);s.getView().getModel("searchModel").setProperty("/results",o);n.setVisible(true)}})}else{s.getView().getModel("searchModel").setProperty("/results",[]);n.setVisible(false)}},onCartPress:function(){this.getOwnerComponent().onCartPress(this.getView())},onCloseCart:function(){this.getOwnerComponent().onCloseCart(this.getView())},updateCartDisplay:function(){this.getOwnerComponent().updateCartDisplay(this.getView())},onAddToCart:function(e){var t=e.getSource().getBindingContext();var o=t.getObject();this.getOwnerComponent().onAddToCart(o)},onPlaceOrder:function(){this.getOwnerComponent().onPlaceOrder(this.getView())}})});
//# sourceMappingURL=cooldrinks.controller.js.map